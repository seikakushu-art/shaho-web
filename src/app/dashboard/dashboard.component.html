<section class="dashboard">
    <header>
      <div>
        <p class="eyebrow">ログイン情報</p>
        <h1>ロール別ダッシュボード</h1>
        <p class="hint">
          ログインユーザーのロールに応じた業務範囲を可視化します。新規ログインは左上メニューから行えます。
        </p>
      </div>
      <a routerLink="/login" class="text-link">ログイン画面へ戻る</a>
    </header>
  
    <section class="card" *ngIf="(roleDefinitions$ | async) as roles">
      <p class="eyebrow">現在のロール</p>
      <h2>{{ roles[0]?.name }}</h2>
      <p class="hint">割り当て: {{ getRoleNames(roles) }}</p>

      <div class="columns" *ngIf="roles[0] as primaryRole">
        <div>
          <h3>担当範囲</h3>
          <ul>
            <li *ngFor="let task of primaryRole.responsibilities">{{ task }}</li>
          </ul>
        </div>
        <div *ngIf="primaryRole.restrictions?.length">
          <h3>制限事項</h3>
          <ul>
            <li *ngFor="let restriction of primaryRole.restrictions">{{ restriction }}</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card" *ngIf="(notifications$ | async) as notifications">
      <header class="section-header">
        <div>
          <p class="eyebrow">承認通知</p>
          <h2>未読バッジ・トースト</h2>
          <p class="hint">承認／差戻し時に申請者と次ステップ承認者へ通知します。</p>
        </div>
        <div class="badge">未読 {{ unreadCount$ | async }} 件</div>
      </header>

      <ul class="notifications">
        <li *ngFor="let notification of notifications">
          <div>
            <p class="eyebrow">{{ notification.createdAt | date: 'MM/dd HH:mm' }}</p>
            <p class="hint">{{ notification.message }}</p>
          </div>
          <span class="status" [class]="notification.unread ? 'status-pending' : 'status-approved'">
            {{ notification.unread ? '未読' : '既読' }}
          </span>
        </li>
      </ul>
    </section>
  
    <section class="card">
      <p class="eyebrow">ロール一覧（システム管理者向け）</p>
      <div class="role-grid">
        <article class="role" *ngFor="let role of allRoles">
          <header>
            <h3>{{ role.name }}</h3>
            <p class="hint">{{ role.summary }}</p>
          </header>
          <ul>
            <li *ngFor="let task of role.responsibilities">{{ task }}</li>
          </ul>
          <p class="hint" *ngIf="role.restrictions?.length">
            制限: {{ role.restrictions?.join(' / ') }}
          </p>
        </article>
      </div>
    </section>
  
    <section class="card">
      <p class="eyebrow">計算機能</p>
      <h2>標準報酬月額 / 標準賞与額 / 社会保険料計算</h2>
      <p class="hint">
        標準報酬月額、標準賞与額、社会保険料の計算を行います。計算対象の指定から結果確認、承認フローまで対応します。
      </p>
      <div class="actions-row">
        <a routerLink="/calculations" class="text-link">計算画面を開く</a>
      </div>
    </section>

    <section class="card">
      <p class="eyebrow">データ閲覧サンプル</p>
      <p class="hint">
        ロールがゲストでも閲覧可能なデモです。担当者・承認者・システム管理者は編集・承認フローを別途実装できます。
      </p>
      <ul class="employees">
        <li *ngFor="let employee of employees$ | async">
          <span class="label">社員番号</span> {{ employee.employeeNo }}
          <span class="label">氏名</span> {{ employee.name }}
        </li>
      </ul>
      <div class="actions-row">
        <a routerLink="/employees/E202501" class="text-link">社員詳細画面を開く（デモ）</a>
        <a routerLink="/approvals" class="text-link">承認一覧画面を開く（デモ）</a>
        <a routerLink="/corporate-info" class="text-link">法人情報設定を開く</a>
        <a routerLink="/insurance-rates" class="text-link">保険料率設定を開く</a>
        <a routerLink="/user-management" class="text-link" *appHasRole="RoleKey.SystemAdmin">ユーザー管理</a>
      </div>
    </section>
  </section>